#!/bin/sh

set -eu

usage() {
  cat <<EOF
usage: backends/lxc/test-package [OPTIONS] PACKAGE OUTPUTDIR [EXTRA-AUTOPKGTEST-ARGS]

$@
EOF
}

# see create-testbed
[ $debci_suite = unstable ] && debci_suite=sid
container_name=$(basename ${debci_test_package:-unknownpackage})-$(date +%s)

debci-autopkgtest --user debci --apt-upgrade "$@" \
  -- lxc --sudo --name "${container_name}" "autopkgtest-${debci_suite}-${debci_arch}"
